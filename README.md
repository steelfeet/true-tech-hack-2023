# Адаптация фильмов для людей с особыми потребностями
(в круглых скобках технические пометки)

https://steelfeet.ru/TrueTechHack/v0.7.html

## Цель
Необходимо разработать дополнительный функционал для плеера KION, который поможет пользователям с особыми потребностями комфортно смотреть любимые фильмы и сериалы.  

Возможные дополнения для плеера:
- Настройка цветовой палитры (блокировка/изменение спектра цветов) изображения
- Настройка яркости, контрастности, насыщенности, резкости изображения
- Включение/выключение сцен, которые могут вызвать эпилептический припадок
- Сохранение настроек для конкретного пользователя
- Возможность выбора рекомендуемых пресетов
Примечание: выше представлены рекомендованные улучшения для плеера, вы также можете погрузиться глубже в проблематику и модифицировать его по своему усмотрению, охватив большую аудиторию.

## Идея №1
"Приглушение" некомфортных для конкретного человека элементов визуальной сцены.

Не меняя картины целиком, уменьшить контрастность, резкость или яркость / изменить цветовой оттенок потенциально "опасных" элементов. Что именно и как решает сам человек (настройки "глушения" на фронте ползунком).  

"Плохие" (они-же "опасные" и "некомфортные") элементы сцены:
- яркие, выделяющиеся на общем фоне;
- яркий, чистый цвет;
- сочетание цветов (красный на зеленом - это красиво, земляничка на листе, а синий на зеленом - нет)
- резкая, быстрая смена яркости / цвета (быстрые движения, взрывы);  
- повторяющиеся смены яркости (машины в лесу);
и т.д.

## Идея №2
Отслеживаем "обычные" настройки (контраста, яркости) обычных пользователей и выделяем сцены, некомфортные для многих. Нейронкой учимся определять такие сцены и превентивно их редактировать.



## Архитектура 1.2 - чистый фронт, обработка пикселей
Оби-Ван против Генерала Гривуса. Звёздные Войны. Поединки
https://www.youtube.com/watch?v=GZNjTSQ9ex0&ab_channel=ArchyFilms

v0.7.html - определение пикселей, сильно ярче среднего  
Недостатки - задевает и просто яркие участки.

v0.8.html - выделение контуров  

v0.9.html - размер и количество контуров

v0.10.html - от v0.8 - управление слоями  

index.html - от v0.8 - управление настройками  


## Решение 1.1
На бекенде используем методы машинного зрения и выделяем контуры (да тот-же Candy и подобные фильтры). Передаем получившуюся маску на фронт и в зависимости от настроек (на фронте) уменьшаем / увеличиваем ЦЯК (Цветность, Яркость, Контраст) контура.

Достоинства: 
- маска для видео выделяется только один раз;
- возможно ручное редактирование маски;
- несколько масок;

Недостатки:  
- маска сильно зависит от настроек фильтра, скорее всего для каждого видео / сцены нужно подбирать свои настройки (решаемо);
- **маску нужно передавать отдельным потоком**, либо сжатым видео (в этом случае надо отдельный декодер (невидимый html5 плеер?)), либо в текстовом формате (SVG?) - что сильно!!! увеличит трафик. Если не сжимать - это по сути несжатое видео получится.
- техническая сложность декодирования и синхронизации (хотя... )

## Решение 1.2
Выделение контуров на фронте.  
Недостатки:  
- Отсутствие готовых реализаций фильтров (а может где-то и есть, надо плагины к videoJS прошерстить)
- Дикая!! нагрузка (ну Doom и пр. то работает (оно на C ())) - нормальная, приемлемая нагрузка

## Решение 2.2
Контуры не выделяем, а разбиваем сцену на квадратики (на беке).
Недостатки:
- пересчитывать каждый раз, при движении ползунка? Так себе решение

## Решение 2.2
Контуры не выделяем, а разбиваем сцену на квадратики (на фронте).
Достоинства:
- сильно проще, сильно меньше нагрузка;
Недостатки:
- квадратики будут выделяться и портить сцену (меняем не пиксели квадратика, а его прозрачность (для цветокоррекции - меняем цвет фона), должно сглаживаться). Добавляем массу маленьких слоев 4*4 пикселя.
Вывод:
для MVP подойдет, хоть посмотреть, как это будет выглядеть.

## Решение 2.2.1
Меняем не прозрачность, а рисуем на canvas?










